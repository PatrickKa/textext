"""
Simple test script to check pattern matching in processing svg paths

Select pattern_old or pattern_new and one of the five text examples in line 47 to see what happens

text_problem is a shows up the problem: v 0 0.21 -> the v 0 is lost in the old pattern
"""
import re

# Original pattern in TexText 0.52
pattern_old = re.compile(r"[a-zA-Z]*\s*\-*\d+\.*\d*,*\-*\d+\.*\d*")

# New pattern to also match things like v 0 0.2
pattern_new = re.compile(r"[a-zA-Z]*\s*\-?\d+\.?\d*(,\-?\d+\.?\d*)?")


# Text example 1: Letter "a" in relative coordinates (after having moved the object)
# Inkscape 0.92
# ==================================================================================
text_1 = "  m 152.03,707.88 0.01,-0.04 v -0.03 l 0.01,-0.04 0.01,-0.04 0.01,-0.04 0.01,-0.03 0.01,-0.04 0.02,-0.03 0.01,-0.04 0.02,-0.03 0.01,-0.04 0.02,-0.03 0.02,-0.03 0.02,-0.04 0.03,-0.03 0.02,-0.03 0.03,-0.02 0.02,-0.03 0.03,-0.03 0.03,-0.02 0.03,-0.02 0.03,-0.03 0.03,-0.02 0.04,-0.01 0.03,-0.02 0.04,-0.01 0.04,-0.02 0.03,-0.01 h 0.04 l 0.05,-0.01 h 0.04 0.04 c 0.21,0 0.82,0.13 0.82,0.94 v 0.56 h -0.25 v -0.56 c 0,-0.58 -0.25,-0.64 -0.36,-0.64 -0.33,0 -0.37,0.45 -0.37,0.5 v 1.99 c 0,0.41 0,0.8 -0.36,1.17 -0.39,0.39 -0.89,0.55 -1.36,0.55 -0.82,0 -1.51,-0.47 -1.51,-1.13 0,-0.29 0.2,-0.46 0.46,-0.46 0.28,0 0.46,0.19 0.46,0.45 0,0.12 -0.05,0.45 -0.51,0.46 0.27,0.35 0.76,0.46 1.08,0.46 0.49,0 1.05,-0.39 1.05,-1.27 v -0.37 -0.21 -0.99 c 0,-0.95 -0.72,-1.29 -1.16,-1.29 -0.49,0 -0.9,0.35 -0.9,0.85 0,0.55 0.42,1.37 2.06,1.43 v 0 0.21 c -0.51,-0.03 -1.2,-0.06 -1.83,-0.36 -0.75,-0.34 -1,-0.85 -1,-1.29 0,-0.81 0.97,-1.05 1.6,-1.05 0.65,0 1.11,0.39 1.3,0.86 z"
text_problem = "  m 152.03,707.88 0.01,-0.04 v -0.03 c 0,-0.95 -0.72,-1.29 v 0 0.21 c -0.51,-0.03 z"


# Text example 2: Letter "a" in absolute coordinates (after having created the object and without moving it afterwards)
# Inkscape 0.92
# ===============================================================================================
text_2 = "  M152.03,707.88 L152.04,707.84 L152.04,707.81 L152.05,707.77 L152.06,707.73 L152.07,707.69 L152.08,707.66 L152.09,707.62 L152.11,707.59 L152.12,707.55 L152.14,707.52 L152.15,707.48 L152.17,707.45 L152.19,707.42 L152.21,707.38 L152.24,707.35 L152.26,707.32 L152.29,707.3 L152.31,707.27 L152.34,707.24 L152.37,707.22 L152.4,707.2 L152.43,707.17 L152.46,707.15 L152.5,707.14 L152.53,707.12 L152.57,707.11 L152.61,707.09 L152.64,707.08 L152.68,707.08 L152.73,707.07 L152.77,707.07 L152.81,707.07 C153.02,707.07,153.63,707.2,153.63,708.01 V708.57 H153.38 V708.01 C153.38,707.43,153.13,707.37,153.02,707.37 C152.69,707.37,152.65,707.82,152.65,707.87 V709.86 C152.65,710.27,152.65,710.66,152.29,711.03 C151.9,711.42,151.4,711.58,150.93,711.58 C150.11,711.58,149.42,711.11,149.42,710.45 C149.42,710.16,149.62,709.99,149.88,709.99 C150.16,709.99,150.34,710.18,150.34,710.44 C150.34,710.56,150.29,710.89,149.83,710.9 C150.1,711.25,150.59,711.36,150.91,711.36 C151.4,711.36,151.96,710.97,151.96,710.09 V709.72 V709.51 V708.52 C151.96,707.57,151.24,707.23,150.8,707.23 C150.31,707.23,149.9,707.58,149.9,708.08 C149.9,708.63,150.32,709.45,151.96,709.51 H151.96 V709.72 C151.45,709.69,150.76,709.66,150.13,709.36 C149.38,709.02,149.13,708.51,149.13,708.07 C149.13,707.26,150.1,707.02,150.73,707.02 C151.38,707.02,151.84,707.41,152.03,707.88 Z"


# Text example 3: Letter "a" in relative coordinates (after having moved the object)
# Inkscape 0.91
# ==================================================================================
text_3 = "m 152.03,707.88 0.01,-0.04 0,-0.03 0.01,-0.04 0.01,-0.04 0.01,-0.04 0.01,-0.03 0.01,-0.04 0.02,-0.03 0.01,-0.04 0.02,-0.03 0.01,-0.04 0.02,-0.03 0.02,-0.03 0.02,-0.04 0.03,-0.03 0.02,-0.03 0.03,-0.02 0.02,-0.03 0.03,-0.03 0.03,-0.02 0.03,-0.02 0.03,-0.03 0.03,-0.02 0.04,-0.01 0.03,-0.02 0.04,-0.01 0.04,-0.02 0.03,-0.01 0.04,0 0.05,-0.01 0.04,0 0.04,0 c 0.21,0 0.82,0.13 0.82,0.94 l 0,0.56 -0.25,0 0,-0.56 c 0,-0.58 -0.25,-0.64 -0.36,-0.64 -0.33,0 -0.37,0.45 -0.37,0.5 l 0,1.99 c 0,0.41 0,0.8 -0.36,1.17 -0.39,0.39 -0.89,0.55 -1.36,0.55 -0.82,0 -1.51,-0.47 -1.51,-1.13 0,-0.29 0.2,-0.46 0.46,-0.46 0.28,0 0.46,0.19 0.46,0.45 0,0.12 -0.05,0.45 -0.51,0.46 0.27,0.35 0.76,0.46 1.08,0.46 0.49,0 1.05,-0.39 1.05,-1.27 l 0,-0.37 0,-0.21 0,-0.99 c 0,-0.95 -0.72,-1.29 -1.16,-1.29 -0.49,0 -0.9,0.35 -0.9,0.85 0,0.55 0.42,1.37 2.06,1.43 l 0,0 0,0.21 c -0.51,-0.03 -1.2,-0.06 -1.83,-0.36 -0.75,-0.34 -1,-0.85 -1,-1.29 0,-0.81 0.97,-1.05 1.6,-1.05 0.65,0 1.11,0.39 1.3,0.86 z"


# Text example 4: Letter "a" in absolute coordinates (after having created the object and without moving it afterwards)
# Inkscape 0.91
# ==================================================================================
text_4 ="  M152.03,707.88 L152.04,707.84 L152.04,707.81 L152.05,707.77 L152.06,707.73 L152.07,707.69 L152.08,707.66 L152.09,707.62 L152.11,707.59 L152.12,707.55 L152.14,707.52 L152.15,707.48 L152.17,707.45 L152.19,707.42 L152.21,707.38 L152.24,707.35 L152.26,707.32 L152.29,707.3 L152.31,707.27 L152.34,707.24 L152.37,707.22 L152.4,707.2 L152.43,707.17 L152.46,707.15 L152.5,707.14 L152.53,707.12 L152.57,707.11 L152.61,707.09 L152.64,707.08 L152.68,707.08 L152.73,707.07 L152.77,707.07 L152.81,707.07 C153.02,707.07,153.63,707.2,153.63,708.01 V708.57 H153.38 V708.01 C153.38,707.43,153.13,707.37,153.02,707.37 C152.69,707.37,152.65,707.82,152.65,707.87 V709.86 C152.65,710.27,152.65,710.66,152.29,711.03 C151.9,711.42,151.4,711.58,150.93,711.58 C150.11,711.58,149.42,711.11,149.42,710.45 C149.42,710.16,149.62,709.99,149.88,709.99 C150.16,709.99,150.34,710.18,150.34,710.44 C150.34,710.56,150.29,710.89,149.83,710.9 C150.1,711.25,150.59,711.36,150.91,711.36 C151.4,711.36,151.96,710.97,151.96,710.09 V709.72 V709.51 V708.52 C151.96,707.57,151.24,707.23,150.8,707.23 C150.31,707.23,149.9,707.58,149.9,708.08 C149.9,708.63,150.32,709.45,151.96,709.51 H151.96 V709.72 C151.45,709.69,150.76,709.66,150.13,709.36 C149.38,709.02,149.13,708.51,149.13,708.07 C149.13,707.26,150.1,707.02,150.73,707.02 C151.38,707.02,151.84,707.41,152.03,707.88 Z "


# This code fails with new pattern because auf groups in the regex (returns only the last part of each match)
#points = re.findall(pattern, text_1)


# Fit to TexText (wants to have points in list)
points = [match.group() for match in re.finditer(pattern_old, text_problem)]

# Check the result
for point in points:
    print(point)